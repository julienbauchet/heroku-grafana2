/*! grafana - v4.0.0-1478693311beta1 - 2016-11-09
 * Copyright (c) 2016 Torkel Ã–degaard; Licensed Apache-2.0 */

System.register(["angular","jquery"],function(a){var b,c,d,e;return{setters:[function(a){b=a},function(a){c=a}],execute:function(){d=b["default"].module("grafana.directives"),e='\n  <div class="panel-container">\n    <div class="panel-header">\n      <span class="alert-error panel-error small pointer" ng-if="ctrl.error" ng-click="ctrl.openInspector()">\n        <span data-placement="top" bs-tooltip="ctrl.error">\n          <i class="fa fa-exclamation"></i><span class="panel-error-arrow"></span>\n        </span>\n      </span>\n\n      <span class="panel-loading" ng-show="ctrl.loading">\n        <i class="fa fa-spinner fa-spin"></i>\n      </span>\n\n      <div class="panel-title-container drag-handle" panel-menu></div>\n    </div>\n\n    <div class="panel-content">\n      <ng-transclude></ng-transclude>\n    </div>\n    <panel-resizer></panel-resizer>\n  </div>\n\n  <div class="panel-full-edit" ng-if="ctrl.editMode">\n    <div class="tabbed-view tabbed-view--panel-edit">\n      <div class="tabbed-view-header">\n        <h2 class="tabbed-view-title">\n          {{ctrl.pluginName}}\n        </h2>\n\n        <ul class="gf-tabs">\n          <li class="gf-tabs-item" ng-repeat="tab in ::ctrl.editorTabs">\n            <a class="gf-tabs-link" ng-click="ctrl.changeTab($index)" ng-class="{active: ctrl.editorTabIndex === $index}">\n              {{::tab.title}}\n            </a>\n          </li>\n        </ul>\n\n        <button class="tabbed-view-close-btn" ng-click="ctrl.exitFullscreen();">\n          <i class="fa fa-remove"></i>\n        </button>\n      </div>\n\n      <div class="tabbed-view-body">\n        <div ng-repeat="tab in ctrl.editorTabs" ng-if="ctrl.editorTabIndex === $index">\n          <panel-editor-tab editor-tab="tab" ctrl="ctrl" index="$index"></panel-editor-tab>\n        </div>\n      </div>\n    </div>\n  </div>\n',d.directive("grafanaPanel",["$rootScope",function(a){return{restrict:"E",template:e,transclude:!0,scope:{ctrl:"="},link:function(b,c){function d(){j.toggleClass("panel-hover-highlight",!0),k.dashboard.setPanelFocus(k.panel.id)}function e(){j.toggleClass("panel-hover-highlight",!1),k.dashboard.setPanelFocus(0)}var f,g,h,i,j=c.find(".panel-container"),k=b.ctrl,l=0;k.containerHeight||(k.calculatePanelHeight(),j.css({minHeight:k.containerHeight}),l=k.containerHeight),k.events.on("render",function(){l!==k.containerHeight&&(j.css({minHeight:k.containerHeight}),l=k.containerHeight),f!==k.panel.transparent&&(j.toggleClass("panel-transparent",k.panel.transparent===!0),f=k.panel.transparent),i=void 0!==k.panel.alert,g!==i&&(j.toggleClass("panel-has-alert",i),g=i),k.alertState?(h&&j.removeClass("panel-alert-state--"+h),"ok"!==k.alertState.state&&"alerting"!==k.alertState.state||j.addClass("panel-alert-state--"+k.alertState.state),h=k.alertState.state):h&&(j.removeClass("panel-alert-state--"+h),h=null)});var m;a.onAppEvent("panel-change-view",function(a,b){m!==k.fullscreen&&(c.toggleClass("panel-fullscreen",!!k.fullscreen),m=k.fullscreen)},b),c.on("mouseenter",d),c.on("mouseleave",e),b.$on("$destroy",function(){c.off()})}}}]),d.directive("panelResizer",["$rootScope",function(a){return{restrict:"E",template:'<span class="resize-panel-handle fa fa-signal"></span>',link:function(b,d){function e(a){a.preventDefault(),m=!0,i=c["default"](a.target).offset(),j=parseInt(n.row.height),k=n.panel.span,l=c["default"](document).width(),h=n.row.panels[n.row.panels.length-1],c["default"]("body").on("mousemove",f),c["default"]("body").on("mouseup",g)}function f(a){n.row.height=Math.round(j+(a.pageY-i.top)),n.panel.span=k+(a.pageX-i.left)/l*12,n.panel.span=Math.min(Math.max(n.panel.span,1),12),n.row.updateRowSpan();var c=n.row.span;Math.floor(c)<14&&(h===n.panel&&c>12?h.span-=c-12:h!==n.panel&&(h.span=h.span-(c-12),h.span=Math.min(Math.max(h.span,1),12))),n.row.panelSpanChanged(!0),b.$apply(function(){n.render()})}function g(){n.panel.span=Math.round(n.panel.span),h&&(h.span=Math.round(h.span)),a.$apply(function(){n.row.panelSpanChanged(),setTimeout(function(){a.$broadcast("render")})}),c["default"]("body").off("mousemove",f),c["default"]("body").off("mouseup",g)}var h,i,j,k,l,m=!1,n=b.ctrl;d.on("mousedown",e);var o=b.$on("$destroy",function(){d.off("mousedown",e),o()})}}}])}}});